<h1>Lyf Ledgerr Dashboard</h1>

<h2>{{ currentDate }}</h2>

<input type="date" (change)="onDateChange($event)" />

<!-- SUMMARY GRID -->
<div class="summary-grid">

  <!-- TODAY -->
  <div class="summary-card">
    <h3>Today</h3>
    <div *ngFor="let item of dailySummary | keyvalue">
      {{ item.key }} : {{ item.value }} hrs
    </div>
    <button (click)="openChart('daily')">View Chart</button>
  </div>

  <!-- WEEKLY -->
  <div class="summary-card">
    <h3>Weekly</h3>
    <div *ngFor="let item of weeklySummary | keyvalue">
      {{ item.key }} : {{ item.value }} hrs
    </div>
    <button (click)="openChart('weekly')">View Chart</button>
  </div>

  <!-- MONTHLY -->
  <div class="summary-card">
    <h3>Monthly</h3>
    <div *ngFor="let item of monthlySummary | keyvalue">
      {{ item.key }} : {{ item.value }} hrs
    </div>
    <button (click)="openChart('monthly')">View Chart</button>
  </div>

</div>

<!-- HOUR GRID -->
<div class="hour-grid">
  <div
    class="hour-card"
    *ngFor="let hour of hours"
    (click)="selectHour(hour)"
    [class.active]="hour === selectedHour"
    [style.background]="hour.category?.color || 'var(--bg-card)'"
  >
    {{ hour.time }}

    <div class="category" *ngIf="hour.category">
      {{ hour.category.name }}
    </div>
  </div>
</div>

<!-- CATEGORY MODAL -->
<div class="modal-backdrop" *ngIf="selectedHour">
  <div class="modal">
    <h3>Select Category for {{ selectedHour.time }}</h3>

    <div class="category-list">
      <button
        *ngFor="let cat of categories"
        (click)="assignCategory(cat)"
        [style.background]="cat.color"
        class="category-btn"
      >
        {{ cat.name }}
      </button>
    </div>

    <button class="close-btn" (click)="selectedHour = null">
      Cancel
    </button>
  </div>
</div>

<!-- CHART MODAL -->
<div class="modal-backdrop" *ngIf="showChart">
  <div class="modal chart-modal">
    <h3>{{ chartMode | titlecase }} Chart</h3>

    <div class="chart-container">
      <canvas id="dailyChart"></canvas>
    </div>

    <button class="close-btn" (click)="closeChart()">Close</button>
  </div>
</div>

<button routerLink="/login">Logout</button>
